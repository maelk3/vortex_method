"""
 The module `Geometry15MW` imports linear interpolation of the blade
 geometry of the NREL 15MW reference wind turbine
"""
module Geometry15MW

export r_15MW, c_15MW, γ_15MW
    
# NREL 15MW offshore wind turbine blade geometry
data = [
 0.000000000000000e+00   1.559455301971172e+01  5.200000000000000e+00
 2.387753704536792e+00   1.558773861176889e+01  5.208839941579524e+00
 4.775507409073585e+00   1.541083467878359e+01  5.237887092263203e+00
 7.163261113610377e+00   1.494855563474368e+01  5.293325313383697e+00
 9.551014818147170e+00   1.425845480678574e+01  5.367339854814920e+00
 1.193876852268396e+01   1.339714163725627e+01  5.452092684226667e+00
 1.432652222722075e+01   1.242201947682708e+01  5.540031728503847e+00
 1.671427593175755e+01   1.139457131628079e+01  5.621824261194381e+00
 1.910202963629434e+01   1.037097608496841e+01  5.692531175149338e+00
 2.148978334083113e+01   9.403999874823057e+00  5.742610890726970e+00
 2.387753704536793e+01   8.551522201182079e+00  5.764836827022541e+00
 2.626529074990471e+01   7.833153039627247e+00  5.756119529852528e+00
 2.865304445444151e+01   7.191354972096501e+00  5.703098512750650e+00
 3.104079815897830e+01   6.551629060916145e+00  5.604676021602162e+00
 3.342855186351510e+01   5.933995702189942e+00  5.471559126660524e+00
 3.581630556805188e+01   5.346089613189348e+00  5.322778014171772e+00
 3.820405927258868e+01   4.796333947019595e+00  5.166482288167050e+00
 4.059181297712547e+01   4.296593562725417e+00  5.019421327310202e+00
 4.297956668166226e+01   3.846955194686785e+00  4.885807888739599e+00
 4.536732038619906e+01   3.445342056797746e+00  4.767959675121795e+00
 4.775507409073585e+01   3.076913909773020e+00  4.654566079625438e+00
 5.014282779527264e+01   2.733562457425842e+00  4.541031051711910e+00
 5.253058149980943e+01   2.412234674442038e+00  4.428175577624730e+00
 5.491833520434623e+01   2.111690772172129e+00  4.316958876583997e+00
 5.730608890888303e+01   1.828396455235506e+00  4.207880735790049e+00
 5.969384261341982e+01   1.558783420877334e+00  4.101646187027423e+00
 6.208159631795661e+01   1.302436869719713e+00  3.998712335312356e+00
 6.446935002249339e+01   1.064427371073839e+00  3.899408676051565e+00
 6.685710372703018e+01   8.434461662411673e-01  3.803172543681295e+00
 6.924485743156698e+01   6.365641868417889e-01  3.709389453654426e+00
 7.163261113610376e+01   4.370289000217617e-01  3.617111741572532e+00
 7.402036484064057e+01   2.396567933387980e-01  3.525634918177657e+00
 7.640811854517736e+01   3.967768814723920e-02  3.434082670567315e+00
 7.879587224971415e+01  -1.728281243479747e-01  3.341933111457596e+00
 8.118362595425094e+01  -4.070838313820219e-01  3.248678447761413e+00
 8.357137965878775e+01  -6.803776144613040e-01  3.156109679927359e+00
 8.595913336332453e+01  -9.992936104276490e-01  3.064580004833834e+00
 8.834688706786133e+01  -1.320525255517711e+00  2.972992647082487e+00
 9.073464077239812e+01  -1.623298762065715e+00  2.880705106690617e+00
 9.312239447693490e+01  -1.884368146311783e+00  2.786969376686517e+00
 9.551014818147171e+01  -2.086230093232373e+00  2.691030938627057e+00
 9.789790188600848e+01  -2.163998201705838e+00  2.591965555977676e+00
 1.002856555905453e+02  -2.175841166085000e+00  2.489323647505217e+00
 1.026734092950821e+02  -2.155303774975188e+00  2.383917231097341e+00
 1.050611629996189e+02  -2.102909521958467e+00  2.275923816206998e+00
 1.074489167041557e+02  -2.018403421317624e+00  2.165466732053696e+00
 1.098366704086924e+02  -1.896743213972770e+00  2.052625082558482e+00
 1.122244241132292e+02  -1.724325762660474e+00  1.937753326819164e+00
 1.146121778177661e+02  -1.508125114401624e+00  1.819662967336163e+00
 1.169999315223028e+02  -1.242387706272970e+00  4.999999999999998e-01]

r_data = data[:,1]
γ_data = data[:,2]
c_data = data[:,3]

"""
    c_15MW(x)

 Computes the chord length at the non dimensional spanwise index `x`

 `x`=0 corresponds to the hub section and `x`=1 the tip.
"""
function c_15MW(x)
    i = 1
    curr_r = r_data[begin]+x*(r_data[end]-r_data[begin])
    while curr_r > r_data[i]
        i += 1
    end
    if i == 1
        return c_data[begin]
    end
    λ = (curr_r-r_data[i-1])/(r_data[i]-r_data[i-1])
    return c_data[i-1] + λ*(c_data[i]-c_data[i-1])
end

"""
    γ_15MW(x)

 Computes the chord length at the non dimensional spanwise index `x`

 `x`=0 corresponds to the hub section and `x`=1 the tip.
"""
function γ_15MW(x)
    i = 1
    curr_r = r_data[begin]+x*(r_data[end]-r_data[begin])
    while curr_r > r_data[i]
        i += 1
    end
    if i == 1
        return γ_data[begin]
    end
    λ = (curr_r-r_data[i-1])/(r_data[i]-r_data[i-1])
    return γ_data[i-1] + λ*(γ_data[i]-γ_data[i-1])
end

"""
    r_15MW(x)

 Computes the radius of the non dimensional spanwise section `x`
"""
function r_15MW(x)
    return r_data[begin]+x*(r_data[end]-r_data[begin])
end

end # Geometry15MW.jl
